Ext.override(Ext.form.Checkbox,{markEl:"wrap",mustCheckText:"This field is required",alignErrorIcon:function(){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])},markInvalid:Ext.form.Checkbox.superclass.markInvalid,clearInvalid:Ext.form.Checkbox.superclass.clearInvalid,validateValue:function(a){if(this.mustCheck&&!a){this.markInvalid(this.mustCheckText);return false}if(this.vtype){var c=Ext.form.VTypes;if(!c[this.vtype](a,this)){this.markInvalid(this.vtypeText||c[this.vtype+"Text"]);return false}}if(typeof this.validator=="function"){var b=this.validator(a);if(b!==true){this.markInvalid(b);return false}}if(this.regex&&!this.regex.test(a)){this.markInvalid(this.regexText);return false}return true},onClick:function(a,b){if(this.readOnly===true){a.preventDefault()}else{if(this.el.dom.checked!=this.checked){this.setValue(this.el.dom.checked)}}}});Ext.override(Ext.form.Field,{initComponent:function(){if(this.required){this.allowBlank=false;this.fieldLabel=this.fieldLabel+((this.labelSeparator)?this.labelSeparator:":")+"<em>required</em>";this.labelSeparator="";this.itemCls="x-form-item-required";this.blankText="This field is required"}Ext.form.Field.superclass.initComponent.call(this);this.addEvents("focus","blur","specialkey","change","invalid","valid")}});Ext.override(Ext.form.Hidden,{reset:function(){this.originalValue=this.defaultValue;this.setValue(this.defaultValue);this.clearInvalid()}});Ext.override(Ext.form.TextField,{defaultValue:null,initComponent:function(){Ext.form.TextField.superclass.initComponent.call(this);this.addEvents("autosize","keydown","keyup","keypress","reset")},reset:function(){Ext.form.TextField.superclass.reset.call(this);this.originalValue=this.defaultValue;this.setValue(this.defaultValue);this.fireEvent("reset");this.applyEmptyText()},setReadOnly:function(a){if(this.rendered){this.el.dom.readOnly=a}this.readOnly=a;if(this.readOnly){this.focusClass=false;this.getActionEl().addClass(this.disabledClass)}else{this.focusClass="x-form-focus";this.getActionEl().removeClass(this.disabledClass)}}});Ext.override(Ext.form.TriggerField,{setReadOnly:function(a){if(a!=this.readOnly){this.readOnly=a;this.updateEditState()}if(this.readOnly){this.focusClass=false;this.wrapFocusClass=""}else{this.focusClass="x-form-focus";this.wrapFocusClass="x-trigger-wrap-focus"}},updateEditState:function(){if(this.rendered){if(this.readOnly){this.el.dom.readOnly=true;this.el.addClass("x-trigger-noedit");this.mun(this.el,"click",this.onTriggerClick,this);this.getActionEl().addClass(this.disabledClass)}else{if(!this.editable){this.el.dom.readOnly=true;this.el.addClass("x-trigger-noedit");this.mon(this.el,"click",this.onTriggerClick,this)}else{this.el.dom.readOnly=false;this.el.removeClass("x-trigger-noedit");this.mun(this.el,"click",this.onTriggerClick,this)}this.trigger.setDisplayed(!this.hideTrigger);this.getActionEl().removeClass(this.disabledClass)}this.onResize(this.width||this.wrap.getWidth())}},onRender:function(b,a){this.doc=Ext.isIE?Ext.getBody():Ext.getDoc();Ext.form.TriggerField.superclass.onRender.call(this,b,a);this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-field-trigger-wrap"});this.trigger=this.wrap.createChild(this.triggerConfig||{tag:"img",src:Ext.BLANK_IMAGE_URL,alt:"",cls:"x-form-trigger "+this.triggerClass});this.initTrigger();if(!this.width){this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth())}this.resizeEl=this.positionEl=this.wrap;if(this.gridEditor){this.mon(this.gridEditor,"beforeshow",function(){var e=this.field.wrap.getSize();var c=("undefined"!=typeof this.field.allowClear&&!this.field.allowClear)?18:36;var d=(!this.field.minEditorWidth||e.width+c>this.field.minEditorWidth)?e.width+c:this.field.minEditorWidth;this.setSize(d,e.height)})}}});Ext.namespace("Ext.ux.form.ComboBox.plugin");Ext.ux.form.ComboBox.plugin.ComboListAutoSizer=(function(){function a(d){var b=d.view&&d.view.getEl()&&d.view.getEl().child(d.itemSelector||".x-combo-list-item");if(!b){return}var c=Ext.util.TextMetrics.createInstance(b);var e=Math.max(d.minListWidth,d.getWidth());d.getStore().each(function(f){e=Math.max(e,c.getWidth(f.get(d.displayField))+25)});d.list.setWidth(e);if(!d.ownerCt){d.minListWidth=e}d.innerList.setWidth(e-d.list.getFrameWidth("lr"));d.list.alignTo(d.wrap,d.listAlign)}return{init:function(c){c.on("expand",a,null,{single:true});var b=c.getStore();b.on("load",function(){a(c)});b.on("update",function(){a(c)})}}})();Ext.preg("comboListAutoSizer",Ext.ux.form.ComboBox.plugin.ComboListAutoSizer);Ext.namespace("Ext.ux.form.field.plugin");Ext.ux.form.field.plugin.FieldHelp=Ext.extend(Object,(function(){function b(c,d){this.el.setSize(c,d)}function a(){if(this.helpText){var d="background-color:transparent; background-repeat:no-repeat;";if("undefined"!=typeof this.checked||this.inputType=="radio"){d+="font-size:13px; padding-left:11px; display:inline; position:relative;";d+=(this.boxLabel!="&#160;")?"left:4px;":"left:-4px;";d+=Ext.isIE?"top:1px;":"top:2px;";if(!this.entendedHelpText){this.extendedHelpText=this.helpText}this.helpText="&nbsp;"}else{d+="color:#888; font-size:10px; line-height:16px; padding-left:18px;"}if(!this.wrap){this.wrap=this.el.wrap({cls:"x-form-field-wrap"});this.positionEl=this.resizeEl=this.wrap;this.actionMode="wrap";this.onResize=this.onResize.createSequence(b)}var c=this.wrap[this.helpAlign=="top"?"insertFirst":"createChild"]({cls:Ext.ux.IconMgr.getIcon("help"),style:d,html:this.helpText});if(this.extendedHelpText){Ext.QuickTips.register({target:c,text:this.extendedHelpText,enabled:true});c.applyStyles({cursor:"help"})}}}return{constructor:function(c,d){this.helpText=c;this.align=d},init:function(c){c.helpAlign=this.align;if("object"!=typeof this.helpText){c.helpText=this.helpText}c.afterRender=c.afterRender.createSequence(a)}}})());Ext.preg("fieldHelp",Ext.ux.form.field.plugin.FieldHelp);Ext.namespace("Ext.ux.form");Ext.ux.form.IsEmptyCheckbox=Ext.extend(Ext.form.Checkbox,{inputValue:"true",hideLabel:true,onRender:function(b,a){Ext.form.Checkbox.superclass.onRender.call(this,b,a);if(this.inputValue!==undefined){this.el.dom.value=this.inputValue}this.wrap=this.el.wrap({cls:"x-form-check-wrap"}).setStyle({paddingLeft:"5px",marginTop:"-10px"});if(this.boxLabel){this.wrap.createChild({tag:"label",htmlFor:this.el.id,cls:"x-form-cb-label",style:"color: #808080;",html:this.boxLabel})}if(this.checked){this.setValue(true)}else{this.checked=this.el.dom.checked}if(Ext.isIE){this.wrap.repaint()}this.resizeEl=this.positionEl=this.wrap;this.sibling=this.previousSibling()},onClick:function(){if(this.el.dom.checked!=this.checked){this.setValue(this.el.dom.checked);if(this.checked&&this.sibling){this.sibling.reset();if(this.sibling.hasListener("focus")){this.sibling.removeListener("focus",this.reset,this)}this.sibling.on("focus",this.reset,this,{single:true})}if(this.ownerCt&&this.ownerCt.buttons){this.ownerCt.buttons[0].handler.call(this.ownerCt)}}},reset:Ext.form.Field.prototype.reset.createSequence(function(){this.originalValue=this.defaultValue;this.setValue(this.defaultValue)})});Ext.ComponentMgr.registerType("isemptycheckbox",Ext.ux.form.IsEmptyCheckbox);Ext.ux.form.ItemSelector=Ext.extend(Ext.form.Field,{hideNavIcons:false,imagePath:"/ExtjsGeneratorPlugin/Ext.ux.IconMgr/icons",iconUp:"control-090.png",iconDown:"control-270.png",iconLeft:"control-180.png",iconRight:"control.png",iconTop:"control-stop-090.png",iconBottom:"control-stop-270.png",drawUpIcon:false,drawDownIcon:false,drawLeftIcon:true,drawRightIcon:true,drawTopIcon:false,drawBotIcon:false,delimiter:",",bodyStyle:null,border:false,defaultAutoCreate:{tag:"div"},delimiter:",",multiselects:null,initComponent:function(){Ext.ux.form.ItemSelector.superclass.initComponent.call(this);this.addEvents({rowdblclick:true,change:true})},onRender:function(d,a){Ext.ux.form.ItemSelector.superclass.onRender.call(this,d,a);var h=[{legend:"Available",draggable:true,droppable:true,width:200,height:200},{legend:"Selected",droppable:true,draggable:true,width:200,height:200}];this.fromMultiselect=new Ext.ux.form.MultiSelect(Ext.applyIf(this.multiselects[0],h[0]));this.fromMultiselect.on("dblclick",this.onRowDblClick,this);this.toMultiselect=new Ext.ux.form.MultiSelect(Ext.applyIf(this.multiselects[1],h[1]));this.toMultiselect.on("dblclick",this.onRowDblClick,this);var g=new Ext.Panel({bodyStyle:this.bodyStyle,border:this.border,layout:"table",width:this.fromMultiselect.width+this.toMultiselect.width+20,layoutConfig:{columns:3}});g.add(this.fromMultiselect);var c=new Ext.Panel({header:false});g.add(c);g.add(this.toMultiselect);g.render(this.el);c.el.down("."+c.bwrapCls).remove();if(this.imagePath!=""&&this.imagePath.charAt(this.imagePath.length-1)!="/"){this.imagePath+="/"}this.iconUp=this.imagePath+(this.iconUp||"control-090.png");this.iconDown=this.imagePath+(this.iconDown||"control-270.png");this.iconLeft=this.imagePath+(this.iconLeft||"control-180.png");this.iconRight=this.imagePath+(this.iconRight||"control.png");this.iconTop=this.imagePath+(this.iconTop||"control-stop-090.png");this.iconBottom=this.imagePath+(this.iconBottom||"control-stop-270.png");var f=c.getEl();this.toTopIcon=f.createChild({tag:"img",src:this.iconTop,style:{cursor:"pointer",margin:"2px"}});f.createChild({tag:"br"});this.upIcon=f.createChild({tag:"img",src:this.iconUp,style:{cursor:"pointer",margin:"2px"}});f.createChild({tag:"br"});this.addIcon=f.createChild({tag:"img",src:this.iconRight,style:{cursor:"pointer",margin:"2px"}});f.createChild({tag:"br"});this.removeIcon=f.createChild({tag:"img",src:this.iconLeft,style:{cursor:"pointer",margin:"2px"}});f.createChild({tag:"br"});this.downIcon=f.createChild({tag:"img",src:this.iconDown,style:{cursor:"pointer",margin:"2px"}});f.createChild({tag:"br"});this.toBottomIcon=f.createChild({tag:"img",src:this.iconBottom,style:{cursor:"pointer",margin:"2px"}});this.toTopIcon.on("click",this.toTop,this);this.upIcon.on("click",this.up,this);this.downIcon.on("click",this.down,this);this.toBottomIcon.on("click",this.toBottom,this);this.addIcon.on("click",this.fromTo,this);this.removeIcon.on("click",this.toFrom,this);if(!this.drawUpIcon||this.hideNavIcons){this.upIcon.dom.style.display="none"}if(!this.drawDownIcon||this.hideNavIcons){this.downIcon.dom.style.display="none"}if(!this.drawLeftIcon||this.hideNavIcons){this.addIcon.dom.style.display="none"}if(!this.drawRightIcon||this.hideNavIcons){this.removeIcon.dom.style.display="none"}if(!this.drawTopIcon||this.hideNavIcons){this.toTopIcon.dom.style.display="none"}if(!this.drawBotIcon||this.hideNavIcons){this.toBottomIcon.dom.style.display="none"}var b=g.body.first();this.el.setWidth(g.body.first().getWidth());g.body.removeClass();this.hiddenName=this.name;var e={tag:"input",type:"hidden",value:"",name:this.name};this.hiddenField=this.el.createChild(e)},doLayout:function(){if(this.rendered){this.fromMultiselect.fs.doLayout();this.toMultiselect.fs.doLayout()}},afterRender:function(){Ext.ux.form.ItemSelector.superclass.afterRender.call(this);this.toStore=this.toMultiselect.store;this.toStore.on("add",this.valueChanged,this);this.toStore.on("remove",this.valueChanged,this);this.toStore.on("load",this.valueChanged,this);this.valueChanged(this.toStore)},toTop:function(){var c=this.toMultiselect.view.getSelectedIndexes();var a=[];if(c.length>0){c.sort();for(var b=0;b<c.length;b++){record=this.toMultiselect.view.store.getAt(c[b]);a.push(record)}c=[];for(var b=a.length-1;b>-1;b--){record=a[b];this.toMultiselect.view.store.remove(record);this.toMultiselect.view.store.insert(0,record);c.push(((a.length-1)-b))}}this.toMultiselect.view.refresh();this.toMultiselect.view.select(c)},toBottom:function(){var c=this.toMultiselect.view.getSelectedIndexes();var a=[];if(c.length>0){c.sort();for(var b=0;b<c.length;b++){record=this.toMultiselect.view.store.getAt(c[b]);a.push(record)}c=[];for(var b=0;b<a.length;b++){record=a[b];this.toMultiselect.view.store.remove(record);this.toMultiselect.view.store.add(record);c.push((this.toMultiselect.view.store.getCount())-(a.length-b))}}this.toMultiselect.view.refresh();this.toMultiselect.view.select(c)},up:function(){var a=null;var c=this.toMultiselect.view.getSelectedIndexes();c.sort();var d=[];if(c.length>0){for(var b=0;b<c.length;b++){a=this.toMultiselect.view.store.getAt(c[b]);if((c[b]-1)>=0){this.toMultiselect.view.store.remove(a);this.toMultiselect.view.store.insert(c[b]-1,a);d.push(c[b]-1)}}this.toMultiselect.view.refresh();this.toMultiselect.view.select(d)}},down:function(){var a=null;var c=this.toMultiselect.view.getSelectedIndexes();c.sort();c.reverse();var d=[];if(c.length>0){for(var b=0;b<c.length;b++){a=this.toMultiselect.view.store.getAt(c[b]);if((c[b]+1)<this.toMultiselect.view.store.getCount()){this.toMultiselect.view.store.remove(a);this.toMultiselect.view.store.insert(c[b]+1,a);d.push(c[b]+1)}}this.toMultiselect.view.refresh();this.toMultiselect.view.select(d)}},fromTo:function(){var e=this.fromMultiselect.view.getSelectedIndexes();var b=[];if(e.length>0){for(var d=0;d<e.length;d++){record=this.fromMultiselect.view.store.getAt(e[d]);b.push(record)}if(!this.allowDup){e=[]}for(var d=0;d<b.length;d++){record=b[d];if(this.allowDup){var a=new Ext.data.Record();record.id=a.id;delete a;this.toMultiselect.view.store.add(record)}else{this.fromMultiselect.view.store.remove(record);this.toMultiselect.view.store.add(record);e.push((this.toMultiselect.view.store.getCount()-1))}}}this.toMultiselect.view.refresh();this.fromMultiselect.view.refresh();var c=this.toMultiselect.store.sortInfo;if(c){this.toMultiselect.store.sort(c.field,c.direction)}this.toMultiselect.view.select(e)},toFrom:function(){var d=this.toMultiselect.view.getSelectedIndexes();var a=[];if(d.length>0){for(var c=0;c<d.length;c++){record=this.toMultiselect.view.store.getAt(d[c]);a.push(record)}d=[];for(var c=0;c<a.length;c++){record=a[c];this.toMultiselect.view.store.remove(record);if(!this.allowDup){this.fromMultiselect.view.store.add(record);d.push((this.fromMultiselect.view.store.getCount()-1))}}}this.fromMultiselect.view.refresh();this.toMultiselect.view.refresh();var b=this.fromMultiselect.store.sortInfo;if(b){this.fromMultiselect.store.sort(b.field,b.direction)}this.fromMultiselect.view.select(d)},valueChanged:function(c){var a=null;var b=[];for(var d=0;d<c.getCount();d++){a=c.getAt(d);b.push(a.get(this.toMultiselect.valueField))}this.hiddenField.dom.value=b.join(this.delimiter);this.fireEvent("change",this,this.getValue(),this.hiddenField.dom.value)},getValue:function(){return this.hiddenField.dom.value},setValue:function(d){this.reset();if(!d){return}var c=[];if(!Ext.isArray(d)){d=d.split(this.delimiter)}if(d.length>0){for(var g=0;g<d.length;g++){var f=this.fromMultiselect.view.store.find(this.fromMultiselect.valueField,d[g]);var b=this.fromMultiselect.view.store.getAt(f);if("object"==typeof b){c.push(b)}}if(!this.allowDup){d=[]}for(var g=0;g<c.length;g++){b=c[g];if(this.allowDup){var a=new Ext.data.Record();b.id=a.id;delete a;this.toMultiselect.view.store.add(b)}else{this.fromMultiselect.view.store.remove(b);this.toMultiselect.view.store.add(b);d.push((this.toMultiselect.view.store.getCount()-1))}}}this.toMultiselect.view.refresh();this.fromMultiselect.view.refresh();var e=this.toMultiselect.store.sortInfo;if(e){this.toMultiselect.store.sort(e.field,e.direction)}this.toMultiselect.view.select(d)},setValue:function(f){this.reset();if(!f){return}if(!Ext.isArray(f)){f=f.split(this.delimiter)}var b,e,d,c,g,a;for(c=0;c<f.length;c++){b=this.fromMultiselect.valueField;e=this.fromMultiselect.displayField;g=f[c];a=this.toMultiselect.view.store.findBy(function(h){return h.data[b]==g});if(a!=-1){continue}a=this.fromMultiselect.view.store.findBy(function(h){return h.data[b]==g});d=this.fromMultiselect.view.store.getAt(a);if(d){this.toMultiselect.view.store.add(d);this.fromMultiselect.view.store.remove(d)}}},onRowDblClick:function(c,a,b,d){if(c==this.toMultiselect.view){this.toFrom()}else{if(c==this.fromMultiselect.view){this.fromTo()}}return this.fireEvent("rowdblclick",c,a,b,d)},reset:function(){range=this.toMultiselect.store.getRange();this.toMultiselect.store.removeAll();this.fromMultiselect.store.add(range);var a=this.fromMultiselect.store.sortInfo;if(a){this.fromMultiselect.store.sort(a.field,a.direction)}this.valueChanged(this.toMultiselect.store)}});Ext.reg("itemselector",Ext.ux.form.ItemSelector);Ext.ns("Ext.ux.form");Ext.ux.form.MultiSelect=Ext.extend(Ext.form.Field,{ddReorder:false,appendOnly:false,width:100,height:100,displayField:0,valueField:1,allowBlank:true,minSelections:0,maxSelections:Number.MAX_VALUE,blankText:Ext.form.TextField.prototype.blankText,minSelectionsText:"Minimum {0} item(s) required",maxSelectionsText:"Maximum {0} item(s) allowed",delimiter:",",defaultAutoCreate:{tag:"div"},initComponent:function(){Ext.ux.form.MultiSelect.superclass.initComponent.call(this);if(Ext.isArray(this.store)){if(Ext.isArray(this.store[0])){this.store=new Ext.data.ArrayStore({fields:["value","text"],data:this.store});this.valueField="value"}else{this.store=new Ext.data.ArrayStore({fields:["text"],data:this.store,expandData:true});this.valueField="text"}this.displayField="text"}else{this.store=Ext.StoreMgr.lookup(this.store)}this.addEvents({dblclick:true,click:true,change:true,drop:true})},onRender:function(c,b){Ext.ux.form.MultiSelect.superclass.onRender.call(this,c,b);var a=this.fs=new Ext.form.FieldSet({renderTo:this.el,title:this.legend,height:this.height,width:this.width,style:"padding:0;",tbar:this.tbar,autoScroll:true});a.body.addClass("ux-mselect");this.view=new Ext.ListView({multiSelect:true,store:this.store,columns:[{header:"Value",width:1,dataIndex:this.displayField}],hideHeaders:true});a.add(this.view);this.view.on("click",this.onViewClick,this);this.view.on("beforeclick",this.onViewBeforeClick,this);this.view.on("dblclick",this.onViewDblClick,this);this.hiddenName=this.name||Ext.id();var d={tag:"input",type:"hidden",value:"",name:this.hiddenName};this.hiddenField=this.el.createChild(d);this.hiddenField.dom.disabled=this.hiddenName!=this.name;a.doLayout()},afterRender:function(){Ext.ux.form.MultiSelect.superclass.afterRender.call(this);if(this.ddReorder&&!this.dragGroup&&!this.dropGroup){this.dragGroup=this.dropGroup="MultiselectDD-"+Ext.id()}if(this.draggable||this.dragGroup){this.dragZone=new Ext.ux.form.MultiSelect.DragZone(this,{ddGroup:this.dragGroup})}if(this.droppable||this.dropGroup){this.dropZone=new Ext.ux.form.MultiSelect.DropZone(this,{ddGroup:this.dropGroup})}},onViewClick:function(c,a,b,d){this.fireEvent("change",this,this.getValue(),this.hiddenField.dom.value);this.hiddenField.dom.value=this.getValue();this.fireEvent("click",this,d);this.validate()},onViewBeforeClick:function(c,a,b,d){if(this.disabled){return false}},onViewDblClick:function(c,a,b,d){return this.fireEvent("dblclick",c,a,b,d)},getValue:function(a){var d=[];var c=this.view.getSelectedIndexes();if(c.length==0){return""}for(var b=0;b<c.length;b++){d.push(this.store.getAt(c[b]).get((a!=null)?a:this.valueField))}return d.join(this.delimiter)},setValue:function(a){var b;var d=[];this.view.clearSelections();this.hiddenField.dom.value="";if(!a||(a=="")){return}if(!Ext.isArray(a)){a=a.split(this.delimiter)}for(var c=0;c<a.length;c++){b=this.view.store.indexOf(this.view.store.query(this.valueField,new RegExp("^"+a[c]+"$","i")).itemAt(0));d.push(b)}this.view.select(d);this.hiddenField.dom.value=this.getValue();this.validate()},reset:function(){this.setValue("")},getRawValue:function(a){var b=this.getValue(a);if(b.length){b=b.split(this.delimiter)}else{b=[]}return b},setRawValue:function(a){setValue(a)},validateValue:function(a){if(a.length<1){if(this.allowBlank){this.clearInvalid();return true}else{this.markInvalid(this.blankText);return false}}if(a.length<this.minSelections){this.markInvalid(String.format(this.minSelectionsText,this.minSelections));return false}if(a.length>this.maxSelections){this.markInvalid(String.format(this.maxSelectionsText,this.maxSelections));return false}return true},disable:function(){this.disabled=true;this.hiddenField.dom.disabled=true;this.fs.disable()},enable:function(){this.disabled=false;this.hiddenField.dom.disabled=false;this.fs.enable()},destroy:function(){Ext.destroy(this.fs,this.dragZone,this.dropZone);Ext.ux.form.MultiSelect.superclass.destroy.call(this)}});Ext.reg("multiselect",Ext.ux.form.MultiSelect);Ext.ux.Multiselect=Ext.ux.form.MultiSelect;Ext.ux.form.MultiSelect.DragZone=function(d,c){this.ms=d;this.view=d.view;var b=c.ddGroup||"MultiselectDD";var a;if(Ext.isArray(b)){a=b.shift()}else{a=b;b=null}Ext.ux.form.MultiSelect.DragZone.superclass.constructor.call(this,this.ms.fs.body,{containerScroll:true,ddGroup:a});this.setDraggable(b)};Ext.extend(Ext.ux.form.MultiSelect.DragZone,Ext.dd.DragZone,{onInitDrag:function(a,c){var b=Ext.get(this.dragData.ddel.cloneNode(true));this.proxy.update(b.dom);b.setWidth(b.child("em").getWidth());this.onStartDrag(a,c);return true},collectSelection:function(b){b.repairXY=Ext.fly(this.view.getSelectedNodes()[0]).getXY();var a=0;this.view.store.each(function(d){if(this.view.isSelected(a)){var e=this.view.getNode(a);var c=e.cloneNode(true);c.id=Ext.id();b.ddel.appendChild(c);b.records.push(this.view.store.getAt(a));b.viewNodes.push(e)}a++},this)},onEndDrag:function(a,b){var c=Ext.get(this.dragData.ddel);if(c&&c.hasClass("multi-proxy")){c.remove()}},getDragData:function(d){var c=this.view.findItemFromChild(d.getTarget());if(c){if(!this.view.isSelected(c)&&!d.ctrlKey&&!d.shiftKey){this.view.select(c);this.ms.setValue(this.ms.getValue())}if(this.view.getSelectionCount()==0||d.ctrlKey||d.shiftKey){return false}var b={sourceView:this.view,viewNodes:[],records:[]};if(this.view.getSelectionCount()==1){var a=this.view.getSelectedIndexes()[0];var f=this.view.getNode(a);b.viewNodes.push(b.ddel=f);b.records.push(this.view.store.getAt(a));b.repairXY=Ext.fly(f).getXY()}else{b.ddel=document.createElement("div");b.ddel.className="multi-proxy";this.collectSelection(b)}return b}return false},getRepairXY:function(a){return this.dragData.repairXY},setDraggable:function(a){if(!a){return}if(Ext.isArray(a)){Ext.each(a,this.setDraggable,this);return}this.addToGroup(a)}});Ext.ux.form.MultiSelect.DropZone=function(d,c){this.ms=d;this.view=d.view;var b=c.ddGroup||"MultiselectDD";var a;if(Ext.isArray(b)){a=b.shift()}else{a=b;b=null}Ext.ux.form.MultiSelect.DropZone.superclass.constructor.call(this,this.ms.fs.body,{containerScroll:true,ddGroup:a});this.setDroppable(b)};Ext.extend(Ext.ux.form.MultiSelect.DropZone,Ext.dd.DropZone,{getTargetFromEvent:function(b){var a=b.getTarget();return a},getDropPoint:function(g,j,d){if(j==this.ms.fs.body.dom){return"below"}var f=Ext.lib.Dom.getY(j),a=f+j.offsetHeight;var i=f+(a-f)/2;var h=Ext.lib.Event.getPageY(g);if(h<=i){return"above"}else{return"below"}},isValidDropPoint:function(b,e,a){if(!a.viewNodes||(a.viewNodes.length!=1)){return true}var c=a.viewNodes[0];if(c==e){return false}if((b=="below")&&(e.nextSibling==c)){return false}if((b=="above")&&(e.previousSibling==c)){return false}return true},onNodeEnter:function(d,a,c,b){return false},onNodeOver:function(h,a,g,d){var b=this.dropNotAllowed;var f=this.getDropPoint(g,h,a);if(this.isValidDropPoint(f,h,d)){if(this.ms.appendOnly){return"x-tree-drop-ok-below"}if(f){var c;if(f=="above"){b=h.previousSibling?"x-tree-drop-ok-between":"x-tree-drop-ok-above";c="x-view-drag-insert-above"}else{b=h.nextSibling?"x-tree-drop-ok-between":"x-tree-drop-ok-below";c="x-view-drag-insert-below"}if(this.lastInsertClass!=c){Ext.fly(h).replaceClass(this.lastInsertClass,c);this.lastInsertClass=c}}}return b},onNodeOut:function(d,a,c,b){this.removeDropIndicators(d)},onNodeDrop:function(b,j,h,f){if(this.ms.fireEvent("drop",this,b,j,h,f)===false){return false}var k=this.getDropPoint(h,b,j);if(b!=this.ms.fs.body.dom){b=this.view.findItemFromChild(b)}if(this.ms.appendOnly){insertAt=this.view.store.getCount()}else{insertAt=b==this.ms.fs.body.dom?this.view.store.getCount()-1:this.view.indexOf(b);if(k=="below"){insertAt++}}var c=false;if(f.sourceView==this.view){if(k=="below"){if(f.viewNodes[0]==b){f.viewNodes.shift()}}else{if(f.viewNodes[f.viewNodes.length-1]==b){f.viewNodes.pop()}}if(!f.viewNodes.length){return false}if(insertAt>this.view.store.indexOf(f.records[0])){c="down";insertAt--}}for(var g=0;g<f.records.length;g++){var a=f.records[g];if(f.sourceView){f.sourceView.store.remove(a)}this.view.store.insert(c=="down"?insertAt:insertAt++,a);var d=this.view.store.sortInfo;if(d){this.view.store.sort(d.field,d.direction)}}return true},removeDropIndicators:function(a){if(a){Ext.fly(a).removeClass(["x-view-drag-insert-above","x-view-drag-insert-left","x-view-drag-insert-right","x-view-drag-insert-below"]);this.lastInsertClass="_noclass"}},setDroppable:function(a){if(!a){return}if(Ext.isArray(a)){Ext.each(a,this.setDroppable,this);return}this.addToGroup(a)}});Ext.namespace("Ext.ux.form");Ext.ux.form.PlainTextField=Ext.extend(Ext.form.TextField,{fieldClass:"x-static-text-field",onRender:function(){this.readOnly=true;this.disabled=!this.initialConfig.submitValue;Ext.ux.form.PlainTextField.superclass.onRender.apply(this,arguments)}});Ext.reg("plaintextfield",Ext.ux.form.PlainTextField);Ext.namespace("Ext.ux.form");Ext.ux.form.TwinComboBox=Ext.extend(Ext.form.ComboBox,{getTrigger:Ext.form.TwinTriggerField.prototype.getTrigger,initTrigger:Ext.form.TwinTriggerField.prototype.initTrigger,trigger1Class:"x-form-clear-trigger",trigger2Class:"",hideTrigger1:true,submitOnSelect:true,submitOnClear:true,allowClear:true,defaultValue:null,triggerAction:"all",plugins:["comboListAutoSizer"],initComponent:function(){Ext.ux.form.TwinComboBox.superclass.initComponent.call(this);this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class}]}},onSelect:Ext.form.ComboBox.prototype.onSelect.createSequence(function(a){if(this.value&&this.ownerCt&&this.ownerCt.buttons&&this.submitOnSelect){this.ownerCt.buttons[0].handler.call(this.ownerCt)}}),onRender:Ext.form.ComboBox.prototype.onRender.createSequence(function(a){this.getTrigger(0).hide()}),setValue:Ext.form.ComboBox.prototype.setValue.createSequence(function(a){if(a!==null&&a!=""){if(this.allowClear){this.getTrigger(0).show()}}else{this.getTrigger(0).hide()}var b=Ext.util.TextMetrics.measure(this.el,this.lastSelectionText).width;if(b>(this.el.getWidth()-20)){this.el.dom.qtip=this.lastSelectionText;this.el.dom.qwidth=b+5;if(Ext.QuickTips){Ext.QuickTips.enable()}}}),reset:Ext.form.ComboBox.prototype.reset.createSequence(function(){this.originalValue=this.defaultValue;this.setValue(this.defaultValue);if(this.allowClear){this.getTrigger(0).hide()}}),onTrigger2Click:function(){if(!this.readOnly){this.onTriggerClick()}},onTrigger1Click:function(){if(!this.disabled&&!this.readOnly){this.clearValue();this.getTrigger(0).hide();if(this.submitOnClear&&this.ownerCt&&this.ownerCt.buttons){this.ownerCt.buttons[0].handler.call(this.ownerCt)}this.el.dom.qtip=null;this.fireEvent("clear",this);this.onFocus()}},applyState:function(b){this.lastSelectionText=b.lastSelectionText?b.lastSelectionText:this.defaultText;var a=b.selectedIndex?b.selectedIndex:this.defaultIndex;this.addRecordToStore(this.lastSelectionText,a)},getState:function(){return{selectedIndex:this.getValue(),lastSelectionText:this.lastSelectionText}},addRecordToStore:function(b,a){if((this.store!==null)&&(a!="")){var c=new Array();c.data=new Array();c.data[0]=new Array();c.data[0][this.valueField]=a;c.data[0][this.displayField]=b;this.store.loadData(c,true)}},findRecord:function(c,b){var a;if(this.store.getCount()>0){this.store.each(function(d){if(d.data[c]==b){a=d}})}return a}});Ext.ComponentMgr.registerType("twincombo",Ext.ux.form.TwinComboBox);Ext.namespace("Ext.ux.form");Ext.ux.form.TwinDateField=Ext.extend(Ext.form.DateField,{getTrigger:Ext.form.TwinTriggerField.prototype.getTrigger,initTrigger:Ext.form.TwinTriggerField.prototype.initTrigger,initComponent:Ext.form.TwinTriggerField.prototype.initComponent,trigger2Class:"x-form-date-trigger",trigger1Class:"x-form-clear-trigger",hideTrigger1:true,submitOnSelect:true,submitOnClear:true,allowClear:true,defaultValue:null,onSelect:Ext.form.DateField.prototype.onSelect.createSequence(function(a){if(this.value&&this.ownerCt&&this.ownerCt.buttons&&this.submitOnSelect){this.ownerCt.buttons[0].handler.call(this.ownerCt)}}),onRender:Ext.form.DateField.prototype.onRender.createSequence(function(a){this.getTrigger(0).hide()}),setValue:Ext.form.DateField.prototype.setValue.createSequence(function(a){if(a!==null&&a!=""){if(this.allowClear){this.getTrigger(0).show()}}else{this.getTrigger(0).hide()}}),reset:Ext.form.DateField.prototype.reset.createSequence(function(){this.originalValue=this.defaultValue;this.setValue(this.defaultValue);if(this.allowClear){this.getTrigger(0).hide()}}),onTrigger2Click:function(){if(!this.readOnly){this.onTriggerClick()}},onTrigger1Click:function(){if(!this.disabled&&!this.readOnly){this.clearValue();this.getTrigger(0).hide();if(this.ownerCt&&this.ownerCt.buttons&&this.submitOnClear){this.ownerCt.buttons[0].handler.call(this.ownerCt)}this.fireEvent("clear",this);this.onFocus()}},clearValue:function(){if(this.hiddenField){this.hiddenField.value=""}this.setRawValue("");this.lastSelectionText="";this.applyEmptyText();this.value=""}});Ext.ComponentMgr.registerType("twindatefield",Ext.ux.form.TwinDateField);Ext.ns("Ext.ux.form");Ext.ux.form.TwinDateTimeField=Ext.extend(Ext.form.Field,{dateValidator:null,defaultAutoCreate:{tag:"input",type:"hidden"},dtSeparator:" ",hiddenFormat:"Y-m-d H:i:s",otherToNow:true,timePosition:"right",timeValidator:null,timeWidth:100,dateFormat:"m/d/Y",timeFormat:"g:i A",initComponent:function(){Ext.ux.form.TwinDateTimeField.superclass.initComponent.call(this);var b=Ext.apply({},{id:this.id+"-date",format:this.dateFormat||Ext.ux.form.TwinDateField.prototype.format,width:this.timeWidth,selectOnFocus:this.selectOnFocus,validator:this.dateValidator,listeners:{blur:{scope:this,fn:this.onBlur},focus:{scope:this,fn:this.onFocus}}},this.dateConfig);this.df=new Ext.ux.form.TwinDateField(b);this.df.ownerCt=this;delete (this.dateFormat);var a=Ext.apply({},{id:this.id+"-time",format:this.timeFormat||Ext.form.TimeField.prototype.format,width:this.timeWidth,selectOnFocus:this.selectOnFocus,validator:this.timeValidator,listeners:{blur:{scope:this,fn:this.onBlur},focus:{scope:this,fn:this.onFocus}}},this.timeConfig);this.tf=new Ext.form.TimeField(a);this.tf.ownerCt=this;delete (this.timeFormat);this.relayEvents(this.df,["focus","specialkey","invalid","valid"]);this.relayEvents(this.tf,["focus","specialkey","invalid","valid"]);this.on("specialkey",this.onSpecialKey,this)},onRender:function(c,a){if(this.isRendered){return}Ext.ux.form.TwinDateTimeField.superclass.onRender.call(this,c,a);var b;if("below"===this.timePosition||"bellow"===this.timePosition){b=Ext.DomHelper.append(c,{tag:"table",style:"border-collapse:collapse",children:[{tag:"tr",children:[{tag:"td",style:"padding-bottom:1px",cls:"ux-datetime-date"}]},{tag:"tr",children:[{tag:"td",cls:"ux-datetime-time"}]}]},true)}else{b=Ext.DomHelper.append(c,{tag:"table",style:"border-collapse:collapse",children:[{tag:"tr",children:[{tag:"td",style:"padding-right:4px",cls:"ux-datetime-date"},{tag:"td",cls:"ux-datetime-time"}]}]},true)}this.tableEl=b;this.wrap=b.wrap({cls:"x-form-field-wrap"});this.wrap.on("mousedown",this.onMouseDown,this,{delay:10});this.df.render(b.child("td.ux-datetime-date"));this.tf.render(b.child("td.ux-datetime-time"));this.df.el.swallowEvent(["keydown","keypress"]);this.tf.el.swallowEvent(["keydown","keypress"]);if("side"===this.msgTarget){var d=this.el.findParent(".x-form-element",10,true);if(d){this.errorIcon=d.createChild({cls:"x-form-invalid-icon"})}var e={errorIcon:this.errorIcon,msgTarget:"side",alignErrorIcon:this.alignErrorIcon.createDelegate(this)};Ext.apply(this.df,e);Ext.apply(this.tf,e)}this.el.dom.name=this.hiddenName||this.name||this.id;this.df.el.dom.removeAttribute("name");this.tf.el.dom.removeAttribute("name");this.isRendered=true;this.updateHidden()},adjustSize:Ext.BoxComponent.prototype.adjustSize,alignErrorIcon:function(){this.errorIcon.alignTo(this.tableEl,"tl-tr",[2,0])},initDateValue:function(){this.dateValue=this.otherToNow?new Date():new Date(1970,0,1,0,0,0)},clearInvalid:function(){this.df.clearInvalid();this.tf.clearInvalid()},markInvalid:function(a){this.df.markInvalid(a);this.tf.markInvalid(a)},beforeDestroy:function(){if(this.isRendered){this.wrap.removeAllListeners();this.wrap.remove();this.tableEl.remove();this.df.destroy();this.tf.destroy()}},disable:function(){if(this.isRendered){this.df.disabled=this.disabled;this.df.onDisable();this.tf.onDisable()}this.disabled=true;this.df.disabled=true;this.tf.disabled=true;this.fireEvent("disable",this);return this},enable:function(){if(this.rendered){this.df.onEnable();this.tf.onEnable()}this.disabled=false;this.df.disabled=false;this.tf.disabled=false;this.fireEvent("enable",this);return this},focus:function(){this.df.focus()},getPositionEl:function(){return this.wrap},getResizeEl:function(){return this.wrap},getValue:function(){return this.dateValue?new Date(this.dateValue):""},isValid:function(){return this.df.isValid()&&this.tf.isValid()},isVisible:function(){return this.df.rendered&&this.df.getActionEl().isVisible()},onBlur:function(a){if(this.wrapClick){a.focus();this.wrapClick=false}if(a===this.df){this.updateDate()}else{this.updateTime()}this.updateHidden();this.validate();(function(){if(!this.df.hasFocus&&!this.tf.hasFocus){var b=this.getValue();if(String(b)!==String(this.startValue)){this.fireEvent("change",this,b,this.startValue)}this.hasFocus=false;this.fireEvent("blur",this)}}).defer(100,this)},onFocus:function(){if(!this.hasFocus){this.hasFocus=true;this.startValue=this.getValue();this.fireEvent("focus",this)}},onMouseDown:function(a){if(!this.disabled){this.wrapClick="td"===a.target.nodeName.toLowerCase()}},onSpecialKey:function(b,c){var a=c.getKey();if(a===c.TAB){if(b===this.df&&!c.shiftKey){c.stopEvent();this.tf.focus()}if(b===this.tf&&c.shiftKey){c.stopEvent();this.df.focus()}this.updateValue()}if(a===c.ENTER){this.updateValue()}},reset:function(){this.df.setValue(this.originalValue);this.tf.setValue(this.originalValue)},setDate:function(a){this.df.setValue(a)},setTime:function(a){this.tf.setValue(a)},setSize:function(a,b){if(!a){return}if("below"===this.timePosition){this.df.setSize(a,b);this.tf.setSize(a,b);if(Ext.isIE){this.df.el.up("td").setWidth(a);this.tf.el.up("td").setWidth(a)}}else{this.df.setSize(a-this.timeWidth-4,b);this.tf.setSize(this.timeWidth,b);if(Ext.isIE){this.df.el.up("td").setWidth(a-this.timeWidth-4);this.tf.el.up("td").setWidth(this.timeWidth)}}},setValue:function(b){if(!b&&true===this.emptyToNow){this.setValue(new Date());return}else{if(!b){this.setDate("");this.setTime("");this.updateValue();return}}if("number"===typeof b){b=new Date(b)}else{if("string"===typeof b&&this.hiddenFormat){b=Date.parseDate(b,this.hiddenFormat)}}b=b?b:new Date(1970,0,1,0,0,0);var a;if(b instanceof Date){this.setDate(b);this.setTime(b);this.dateValue=new Date(Ext.isIE?b.getTime():b)}else{a=b.split(this.dtSeparator);this.setDate(a[0]);if(a[1]){if(a[2]){a[1]+=a[2]}this.setTime(a[1])}}this.updateValue()},setVisible:function(a){if(a){this.df.show();this.tf.show()}else{this.df.hide();this.tf.hide()}return this},show:function(){return this.setVisible(true)},hide:function(){return this.setVisible(false)},updateDate:function(){var a=this.df.getValue();if(a){if(!(this.dateValue instanceof Date)){this.initDateValue();if(!this.tf.getValue()){this.setTime(this.dateValue)}}this.dateValue.setMonth(0);this.dateValue.setFullYear(a.getFullYear());this.dateValue.setMonth(a.getMonth(),a.getDate())}else{this.dateValue="";this.setTime("")}},updateTime:function(){var a=this.tf.getValue();if(a&&!(a instanceof Date)){a=Date.parseDate(a,this.tf.format)}if(a&&!this.df.getValue()){this.initDateValue();this.setDate(this.dateValue)}if(this.dateValue instanceof Date){if(a){this.dateValue.setHours(a.getHours());this.dateValue.setMinutes(a.getMinutes());this.dateValue.setSeconds(a.getSeconds())}else{this.dateValue.setHours(0);this.dateValue.setMinutes(0);this.dateValue.setSeconds(0)}}},updateHidden:function(){if(this.isRendered){var a=this.dateValue instanceof Date?this.dateValue.format(this.hiddenFormat):"";this.el.dom.value=a}},updateValue:function(){this.updateDate();this.updateTime();this.updateHidden();return},validate:function(){return this.df.validate()&&this.tf.validate()},renderer:function(c){var b=c.editor.dateFormat||Ext.ux.form.TwinDateTimeField.prototype.dateFormat;b+=" "+(c.editor.timeFormat||Ext.ux.form.TwinDateTimeField.prototype.timeFormat);var a=function(e){var d=Ext.util.Format.date(e,b);return d};return a}});Ext.reg("twindatetime",Ext.ux.form.TwinDateTimeField);Ext.namespace("Ext.ux.form");Ext.ux.form.TwinFileUploadField=Ext.extend(Ext.form.TwinTriggerField,{getTrigger:Ext.form.TwinTriggerField.prototype.getTrigger,initTrigger:Ext.form.TwinTriggerField.prototype.initTrigger,trigger1Class:"x-form-clear-trigger",hideTrigger1:true,trigger2Class:"x-form-search-trigger",validationEvent:false,validateOnBlur:false,readOnly:true,updateEditState:function(){if(this.rendered){if(this.readOnly){this.el.dom.readOnly=true;this.el.addClass("x-trigger-noedit");this.mon(this.el,"click",this.onTriggerClick,this)}else{if(!this.editable){this.el.dom.readOnly=true;this.el.addClass("x-trigger-noedit");this.mon(this.el,"click",this.onTriggerClick,this)}else{this.el.dom.readOnly=false;this.el.removeClass("x-trigger-noedit");this.mun(this.el,"click",this.onTriggerClick,this)}this.trigger.setDisplayed(!this.hideTrigger)}this.onResize(this.width||this.wrap.getWidth())}},initComponent:function(){Ext.ux.form.TwinFileUploadField.superclass.initComponent.call(this);if(Ext.util.CSS.getRule(".x-form-file")==null){var a=".x-form-file-cabinet {position: relative;}.x-form-file-wrapper {position: absolute; display: block; height: 22px; width: 18px; overflow: hidden;}.x-form-file {cursor: pointer; position: absolute; height: 22px; right: 0; opacity: 0; -moz-opacity: 0; filter: alpha(opacity=0);}";var b=Ext.util.CSS.createStyleSheet("/* Ext.ux.form.TwinFileUploadField stylesheet */\n"+a,"TwinFileUploadField");Ext.util.CSS.refreshCache()}this.addEvents("fileselected");this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class},{tag:"span",cls:"x-form-file-cabinet",cn:[{tag:"div",id:this.getFileWrapperId(),cls:"x-form-file-wrapper"}]}]}},onRender:function(b,a){Ext.ux.form.TwinFileUploadField.superclass.onRender.call(this,b,a);this.triggers[0].hide();this.wrapper=Ext.get(this.getFileWrapperId());this.createFileInput();this.bindListeners();this.getTrigger(1).on({mousemove:{fn:function(){this.wrapper.setXY(this.getTrigger(1).getXY())},scope:this}})},bindListeners:function(){this.fileInput.on({scope:this,mouseenter:function(){this.getTrigger(1).addClass("x-form-trigger-over")},mouseleave:function(){this.getTrigger(1).removeClass("x-form-trigger-over")},mousedown:function(){this.getTrigger(1).addClass("x-form-trigger-click")},mouseup:function(){this.getTrigger(1).removeClass("x-form-trigger-click")},change:{fn:this.handleFile,scope:this}})},reset:function(){this.fileInput.remove();this.createFileInput();this.bindListeners();Ext.ux.form.TwinTriggerField.superclass.reset.call(this)},setValue:Ext.form.TwinTriggerField.prototype.setValue.createSequence(function(a){this.getEl().dom.qtip=a;this.getEl().dom.qwidth=Ext.util.TextMetrics.measure(this.getEl(),a).width+12;if(Ext.QuickTips){Ext.QuickTips.enable()}}),handleFile:function(){var a=this.fileInput.dom.value.replace(/\//g,"\\");var b=a.lastIndexOf("\\");var c=a.substring(b+1);this.setValue(c);this.fireEvent("fileselected",this,c);this.getTrigger(0).show()},onDestroy:function(){Ext.ux.form.TwinFileUploadField.superclass.onDestroy.call(this);Ext.destroy(this.fileInput,this.wrapper)},onDisable:function(){Ext.ux.form.TwinFileUploadField.superclass.onDisable.call(this);this.doDisable(true)},onEnable:function(){Ext.ux.form.TwinFileUploadField.superclass.onEnable.call(this);this.doDisable(false)},doDisable:function(a){this.fileInput.dom.disabled=a},preFocus:Ext.emptyFn,onTrigger1Click:function(){this.clearValue();this.getTrigger(0).hide();this.fileInput.remove();this.createFileInput();this.bindListeners()},createFileInput:function(){this.fileInput=this.wrapper.createChild({id:this.getFileInputId(),name:this.name||this.getId(),cls:"x-form-file",tag:"input",type:"file",width:1})},clearValue:function(){this.setRawValue("");this.setValue("");this.value=""},getFileInputId:function(){return this.id+"-file"},getFileWrapperId:function(){return this.id+"-wrapper"}});Ext.reg("twinfileuploadfield",Ext.ux.form.TwinFileUploadField);